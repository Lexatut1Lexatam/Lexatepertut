# Kicadoc

### Программа для генерации КД

Kicadoc генерирует ведомость покупных изделий (ВП), перечень элементов (ПЭ3) и спецификацию из файла poject_name.net. 

#### Генерация файла poject_name.net

  - Открыть файл poject_name.sch в Kicad Easchema
  - Открыть вкладку Tools
  - Нажать кнопку "Generate Netlist File"
  - Во окне Netlist, во вкладке PcbNew установить галочку "Default format"
  - Нажать кнопку "Generate Netlist" 

#### Генерация КД 

  - В командной строке ввести: python3 kicadoc.pyw
  - Открыть сгенерированный ранее poject_name.net в открывшемся окне. (Drag and drop работает)
  - Для автоматического заполнение полей "Разраб., Пров. и т.п." в КД, необходимо заполнить соответствующие поля в файле poject_name.sch.
  - Для добавления дополнительных строк необходимо выделить строку и нажать кнопки "Добавить строку выше" или "Добавить строку ниже".
  - После добавления строк в спецификацию или ВП необходимо перестроить номера позиций нажав соответствующую кнопку на панеле инструментов. Для корректного выполенния перестройки позиций необходимо чтобы поля "Кол.", "На изделие" и "Всего" были заполнены.
  - Для создания нового раздела или заголовка группы, необходимо вставить новую строку, ввести навание и определить формат текста с помощью соответствующих кнопок на панеле инструментов.
  - Для генерации только одного документа необходимо открыть вкладку этого документа и нажать кнопку сохранить. Выбрать формат генерируемого файла (*.pdf, *.tex, *.csv).
  - Для генерации всех документов необходимо нажать кнопку "Сохранить всё".
  - Для настройки генератора КД требуется редакция файла settings.conf.
  
#### Настройки settings.conf.

######  # Общие настройки таблиц
[table]
######  # Разделитель в объединенных позиционных обозначениях (C2-C4, C3...C5) 
ref separator = -
######  # Объединять группы с одинаковыми наименованиями (ПЭ3)
concatenate same name groups = yes
######  # Добавить единицы измерения
add units = yes
######  # Добавить пробел перед единицами измерения
space before units = yes
######  # Заголовок со стандартом
title with doc = no
######  # В каждой группе есть заголовок
every group has title = yes
######  # Добавить пустую строку после заголовка группы
empty row after group title = no
######  # Количество пустых строк между группами
empty rows between diff type = 1
######  # Количество пустых строк между разными обозначениями (ПЭ3)
empty rows between diff ref = 1
######  # Разделить группы по стандартам
separate group for each doc = no
######  # Зарезервировать номера позиций
reserve position numbers = no
######  # Нумеровать строки только для компонентов (ВП)
only components have position numbers = no
######  # Обрабатывать повторяющиеся значения (ВП)
process repeated values = no
######  # Разделы спецификации
[sections]
######  # 1. Документация
documentation = yes
######  # Схема электрическая принципиальная
schematic = yes
######  # Перечень элементов
index = yes
######  # Ведомость покупных изделий
bom = yes
######  # Ведомость документов на носителях данных
docsheet = yes
######  # Информационно-удостоверяющий лист
certsheet = yes
######  # Карты рабочих режимов
opmodemaps = yes
######  # Сборочный чертеж
assembly drawing = yes
######  # 2. Сборочные единицы
assembly units = no
######  # 3. Детали
details = yes
######  # Плата печатная
pcb = yes
######  # 4. Стандартные изделия
standard parts = no
######  # 5. Прочие изделия
other parts = yes
######  # 6. Материалы
materials = no
######  # Поля таблиц
[fields]
######  # Тип (группа компонентов)
type = Группа
######  # Наименование
name = ${|Марка|}${ |Значение|}${ |Класс точности|}${-|Тип|}
######  # Стандарт
doc = Стандарт
######  # Примечание
comment = Примечание
######  # Регулируемый компонент
adjustable = Подбирают при регулировании
######  # Код продукции
code = 
######  # Поставщик
dealer = 
######  # Куда входит (обозначение)
for what =
######  # Исключенный компонент
excluded = Исключён из ПЭ
######  # Основная надпись
[stamp]
######  # Обработать наименование документа
convert doc title = yes
######  # Обработать обозначение документа
convert doc id = yes
######  # Заполнить Перв. примен. (графа 25)
fill first usage = yes
######  # Поместить обозначение в заголовок таблицы (для групповых документов)
place doc id to table title = yes
######  # Псевдонимы
[aliases]
Значение = Номинал
######  # Настройки модулей вывода
[output]
######  # Путь к стилевым пакетам
latex_path = latex/
######  # Файл шаблона LaTeX
latex_template = latex/template.tex
######  # Разделитель в файлах CSV
csv_delimiter = \t
######  # Формат экспорта по умолчанию
default_type = pdf
